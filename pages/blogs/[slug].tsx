import Head from 'next/head';
import { useRouter } from 'next/router';
import {  useState } from 'react';
import Container from '../../components/container/Container';
import styles from '../../styles/Blog.module.css';
import path from 'path';
import { promises as fs } from 'fs';
import { GetStaticPaths, GetStaticProps } from 'next/types';
export const getStaticPaths : GetStaticPaths = async() =>{
  return{
    paths:[
      {params:{slug:"learn-html"}},
      {params:{slug:"learn-css"}},
      {params:{slug:"learn-javascript"}},
    ],
    fallback:true
  }
}
export const getStaticProps : GetStaticProps = async(ctx:any) =>{
  let {slug} = ctx.params;
  let jsonDirectory = path.join(process.cwd(), "json/tutorials");
  let blog : any = await fs.readFile(jsonDirectory + "/" + slug +".json", "utf-8");
  console.log(slug)
  return{
    props:{
      blog : JSON.parse(blog)
    }
  }
}
export default function Slug({blog} : any) {
    const router = useRouter();
    const [blogdata] = useState<any>(blog);
   
    if (router.isFallback) {
      return <div>Loading...</div>
    }
  return (
    <Container>
      <Head>
        <title>{`Blogs | ${blogdata.title}`} </title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        <h1 className={styles.title}>
          {blogdata.title} - Course       </h1>
        <div className={styles.grid}>
                <h2>{blogdata.title}</h2>
                <p>{blogdata.description}</p>
        </div>
      </main>    
    </Container>
  )
}
